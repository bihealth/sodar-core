{% extends 'projectroles/base.html' %}

{% load rules %}
{% load static %}
{% load timeline_tags %}
{% load projectroles_common_tags %}

{% block title %}
  {{ timeline_title }} {% if timeline_mode == 'project' %}for{% else %}in{% endif %}
  {{ project.title }}
{% endblock title %}

{% block css %}
  {{ block.super }}
  <!-- Timeline CSS -->
  <link rel="stylesheet" type="text/css" href="{% static 'timeline/css/timeline.css' %}" />
{% endblock css %}

{% block projectroles %}

{% has_perm 'timeline.view_site_admin' request.user project as can_view_timeline %}
{% get_plugin_lookup as plugin_lookup %}

<div class="row sodar-subtitle-container bg-white sticky-top">
  <h2><i class="iconify" data-icon="mdi:clock-time-eight"></i> {{ timeline_title }}</h2>
  {% if timeline_mode == 'object' %}
    <div class="ml-auto">
      <a href="{% url 'timeline:list_site' %}"
         class="btn btn-secondary ml-auto" role="button">
        <i class="iconify" data-icon="mdi:arrow-left-circle"></i>
        Admin Site Events
      </a>
    </div>
  {% endif %}
</div>

<div class="container-fluid sodar-page-container">

  {% if object_list.count > 0 %}
    <div class="card mb-3" id="sodar-tl-event-list">
      <div class="card-body p-0">
        <table class="table table-striped sodar-card-table" id="sodar-tl-table">
          <thead>
            {% include 'timeline/_list_header.html' %}
          </thead>
          <tbody>
            {% for event in object_list %}
              {% include 'timeline/_list_item.html' with site_admin=True %}
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    {% if is_paginated %}
      {% include 'projectroles/_pagination.html' with pg_small=False %}
    {% endif %}
   {% else %}
    <div class="alert alert-info" role="alert">
      No site-wide timeline events found{% if timeline_mode == 'object' %} for this object{% endif %}.
    </div>
  {% endif %}
</div> <!-- sodar-page-container -->

{% endblock projectroles %}

